{
    "id": "f605b5fb-7016-4991-929f-9451b9082955",
    "url": "file:///app/collector/hotdir/JAM Session _1597 PowerFAIDS Import File Automation.pdf",
    "title": "JAM Session _1597 PowerFAIDS Import File Automation.pdf",
    "docAuthor": "no author found",
    "description": "No description found.",
    "docSource": "pdf file uploaded by the user.",
    "chunkSource": "",
    "published": "7/28/2024, 12:48:02 PM",
    "wordCount": 3090,
    "pageContent": "© 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  Presented by Westminster College June Date, 2016  PowerFAIDS Import File Automation © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Matthew Vore – Director of Enterprise Data Management – matthew.vore@westminster-mo.edu     Ryan Smith – Programmer Analyst – Enterprise Data Management – ryan.smith@westminster-mo.edu     Our Background  •   User Centered Web & Application Development, IT, SQL, Programming  •   Know very little about PowerFAIDS  •   Know how to ask the right questions to quickly get a solution going  Presenters & Background © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     900-1200 Students     20% International Students     Westminster does not use the payroll / timesheet function in EX, all done externally via ADP     ALL Student Employment is handled by the Financial Aid Office  •   Two Types     College Employment (No federal financial aid money)     Work Study (Financial Aid money)     Campus Employment job process is digital (SharePoint 2010, Built in 2010)  •   Students only get access if they are eligible  •   This filters most “mistakes” that could happen, but not all (changes to Financial Aid after hiring process etc)  •   Need to move to JICS with custom portlet (on to do list)  Westminster College © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Upcoming changes to PowerFAIDS will mean changes to the following processes/code  •   Changing from set-width file imports to XML based  •   Will change the export view from a flat line by line to wrapping the fields in xml tags (ie: <first_name>Matt</first_name> etc, should be a relatively easy update  •   They are also adding a section to keep track of Campus Work, Import may need to change to this area  •   Found out AFTER submitting the presentation...but we have replicated this type of process for several different issues on campus     This was a “quick and dirty” project to help the Financial AID office with a quick solution to the manual work they were doing, code is quick and ugly!  Disclaimer © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Financial Aid Office was having trouble keeping track of YTD payments compared to awards     ADP reporting only allowed reports per pay period, not comprehensive  •   FA office has to manually combine multiple excel files / keep master excel file to keep track of totals  •   Manual process with human error, spent 1-2 days every two weeks entering and double checking each students data...     Data in payroll system (ADP) isn’t the best  •   International Students don’t have SSN initially  •   StudentID field doesn’t have enough characters to store full ID_NUM     Updates/Changes in Financial Aid weren’t reflected in manual tracking  •   Students would be working that weren’t eligible  •   Students would work after going over their allotted financial aid  The Problem © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     No, Just no, there is a better way     Wanted process to be minimal for Financial AID office AND IT, build it once and then let the computers do the hard work     EDM team has been focused on creating full or semi automated processes all over campus to reduce the amount of time we spend doing “busy work”, and more time doing important work for ourselves and other departments     Met with financial aid office for initial analysis of needs  •   Financial Aid Office is well versed in PowerFAIDS, wants reporting in one system, would like data imported directly to PowerFAIDS as disbursements  •   Need to be able to find “exceptions”, those who are getting paid that aren’t eligible, as well as those who aren’t showing up  •   ADP Data needs cleaned (PowerFAIDS & Jenzabar data)  Can you help me use Microsoft Access? © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Create a stored procedure that will import data from a file on a share drive, and then provide a cleaned PowerFAIDS External Disbursement File for importing into PowerFAIDS, an exceptions list and stores the data in a table for future fully accurate reporting (PowerFAIDS External Disbursements didn’t easily include cents)     Give access to activate the Stored Procedure directly to Financial Aid Office via MYWC Contained Form Portlet     New Process would be:  •   Financial Aid office prepares file from ADP and saves as tab delimited text file  •   Financial Aid Drags file into a folder on newly created shared drive  •   Financial Aid Clicks “GO” on a MYWC form     A dated disbursement file and dated exceptions file is exported in an “output” folder of the shared drive  •   File they added to shared folder is archived and deleted in preparation for next file  After initial research....THIS WILL BE EASY © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  Breakdown the complexity     Create Shared Drive     Create Process to Archive/Delete the Import.txt files     Figure out the fields needed from the ADP field to create the disbursement file     Create a table for the import.txt to go into     Create a view for exceptions based on data in table above     Create a view with all the required fields for the PowerFAIDS external disbursement file     Create a table that stores the raw data of all imports in for accurate totals reporting     Create a stored procedure that imports the data from the file into the new table, the totals table, archives & deletes the import file, creates the exceptions file, creates the disbursement file     Create contained form portlet to activate the stored procedure when button is pressed  What we need to do © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Created folder on our SQL2012 server, shared to Financial Aid group/EDM team only, and added to their AutoMap file     Created Archive Folder     Created Output Folder     Created .BAT file for copying ALL .txt files to archive folder     Created .BAT file for deleting all .txt files in root folder  The Shared Drive © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  (I stole this from something our previous SysAdmin had setup for previous process)  @echo off set todayrandom=%random% set Logfile=c:\\CampusEmploymentProcess\\Archive\\copyfiles2archive%todayrandom%.log echo Todays random filetype name is: .csv%todayrandom% > %Logfile% :file1 if exist C:\\CampusEmploymentProcess\\Import.txt goto backup1 else goto file2 :backup1 copy   C:\\CampusEmploymentProcess\\Import.txt C:\\CampusEmploymentProcess\\Archive\\Import%todayrandom%.txt >> %Logfile% goto END :END  Batch File (CopyFiles2Archive.bat – Copy to Archive) © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  CD\\CampusEmploymentProcess DEL *.txt /Q     Change .txt to .csv if using csv files  Batch File (ClearCSV.BAT - delete files in root) © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Worked_In_Department_Description – We have two types of employment, College Employment (non financial aid) and Work Study (financial aid), both are tracked by Financial Aid (they own all student employment)     Tax_ID_SSN – Social Security Number     File_Number – Student ID, limited to less characters than our ID’s have...     Payroll_Name – Students name     Pay_Date – Date of the payment     Regular_Hours_Total – Hours worked     Regular_Earnings_Total – Earnings from hours     RA_AC_Pmts – Residential Advisors are paid a different amount and it shows up here instead of regular earnings  The ADP File © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Some programmers would simply do all of the steps I listed inside the stored procedure, utilizing temporary tables/views and then deleting when done...nothing wrong with this and probably more efficient     I’m a GUI person, reading code to figure out processes takes longer than visually looking at the tables/views the process uses vs looking at them in code form only     Prefer to break it down into pieces to help reduce the complexity / understanding for those who will need to maintain     We prefer to use actual tables that stay in the system, allows the use of the bulk import feature and the data stays in the table until the process is run again, allowing us to troubleshoot when it fails     I like to use “Views” to clean my data, so that my stored procedures simply reference a clean view instead of having to have lots of data handling, these are easier to create for a permanent temporary table vs a temp table     Stored procedure cleans out the table, then does bulk import, then stored procedure does stuff with data in the “views”  I’m wierd © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     _WC_CollegeEmployment_Import     Steps to create:  •   Clean ADP file     Delete headers (not column headers, keep these initially)     Try to pick a file that has a decent amount of data, so that the data import process knows what type of column it should be  •   In SQL, Right Click Database (TMSEPRD) -> Tasks -> Data Import     Choose Flat File, choose your .txt file     Automatically determines column type based on data in the file you initially import     Make changes as you see fit before starting the import     Change column names (I like using _ instead of spaces for my column names)  The import table © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     First we created documentation on how to clean future ADP files including removing the column headers for Financial Aid Team, so that only useful data is imported     File must always be named Import.txt for stored procedure to work     Test code below on a few files to ensure imports work fine  BULK INSERT _WC_CollegeEmployment_IMPORT FROM 'c:\\CampusEmploymentProcess\\Import.txt' WITH ( FIELDTERMINATOR = '\\t', ROWTERMINATOR = '\\n' )  Bulk Import Code © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  declare @CreateArchives varchar(256) select @CreateArchives = 'C:\\CampusEmploymentProcess\\CopyFiles2Archive.bat' exec xp_cmdshell @CreateArchives WAITFOR DELAY '00:00:02' declare @DeleteCSVFiles varchar(256) select @DeleteCSVFiles = 'C:\\CampusEmploymentProcess\\ClearCSV.bat' exec xp_cmdshell @DeleteCSVFiles  Activate Batch Files from Stored Procedure © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     _WC_V_CollegeEmployment_NotFound     First view is our “exceptions” view, or those that should not be in the import file. Over time we have come up with three exceptions:  •   No SSN Match (Can’t find the SSN in Jenzabar, therefore can’t get PowerFAIDS data)     Our most frequent one, takes a while to get the I-10 for international students  •   Not Eligible – Student doesn’t have a financial aid award for either employment type  •   No Employment Status – Can’t even find them in the view that looks at their eligibility, happens when student is put in a status that’s not current in PowerFAIDS     Notes:  •   We cheated, we used a view that had already been created for our Campus Employment Application system that had a Y/N field for eligibility of each employment type, will include it in resources as well  The Exceptions View © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  declare @SQL varchar(8000) select @SQL = 'bcp tmseprd.dbo._WC_V_CollegeEmployment_NotFound out c:\\CampusEmploymentProcess\\Output\\Exceptions'++REPLACE(REPLACE(REPLACE( NVERT(varchar,CURRENT_TIMESTAMP, 20),'-','-'),':','-'),' ','-')   +'.csv -c -t, -T -S' + @@SERVERNAME exec xp_cmdshell @SQL     Code above exports the view as a csv file with a timestamp in the filename.  Export that view into an exceptions file © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  PowerFAIDS External Disbursement File Requirements © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  The disbursement file view © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     _WC_V_CollegeEmployment_Export     Highlights  •   Used replicate(‘ ‘,16) to keep track of the number of spaces needed to add (16 being number of spaces required for Last_Name  •   Don’t have to use First/Last, so just used blank spaces     SQL for Carriage Return/Line Feed below: ,char(13) as 'Carriage_Return‘ ,char(10) as 'Line_Feed‘     Had to pull data from Name_Master, Biograph_master, student employment view and where SSN is NOT IN the Exceptions view created ealier  The disbursement file view © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Combination of previous slides     Highlights:  •   Had to use Cursor to create the disbursement file due to an extra space after the carriage return instead of line feed to get the import file to import correctly, couldn’t make it work with a direct out from the view  •   Delete _IMPORT table first thing in the stored procedure  •   Created a totals table that matched the import file with a batch number added  •   Found sometimes we needed to make changes to the total table, added options in stored procedure  •   Stored procedure has options:     D – Delete the last batch added to totals table     I – Import all lines into the totals table regardless of exceptions (where SSN is valid)  Overview of Stored Procedure © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Delete Import Table     Import data from Import.txt file     Archive .Txt file     Delete .txt file     If D option specified THEN Delete last totals batch (added BatchNum as field)     If I option specified (Add to totals table, end stored procedure)     Add non-exceptions to totals table     Export Exceptions file     Export Disbursement File  Walk through of Stored Procedure © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     NOT so easy....long story short:  •   Bulk Import & XP_CMDSHELL require special permissions in SQL     We fixed this issue for a different process by creating a service account and using impersonation, but haven't tested this yet on this process     This could be a session on it’s own, I can provide links and information just contact  Now the EASY part...add stored procedure to MYWC... © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort  •   Receives file from ADP  •   Cleans file & puts in root folder of shared drive as Import.txt  •   Sends Help Ticket or Calls IT, they click “run” on process (under 1 min)  •   Fix exceptions (if needed) and re-run  •   Import Disbursement Files into PowerFAIDS  •   Run reports in PowerFAIDS  Process Improvement  •   Process went from 1-2 days every few weeks to 5-30 minutes every few weeks  •   MUCH more accurate and up to date, data is in PowerFAIDS for easy reporting  •   Catch exceptions much easier and quicker  Actual Process for Financial Aid © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     We have used this type of process in several different instances, generally processes we don’t want to have to frequently run for other departments when it’s something they don’t have privileges to do     Examples:  •   Cleaning up bad data for the Daily Procedure for Enrollment, also added a simple query portlet that gave them error details from application_log_details  •   Importing ACT scores & students  •   We created a contained form portlet that activates a powershell command to activate or de-activate security for Student Workers who need Jenzabar Access (AD Authentication)  •   Contained Form Portlet / Stored Procedure to update Address Line 3 on *EML for enrollment  Reuse this process for many things... © 2016 Jenzabar, Inc.   June 1 - 4, 2016 Gaylord Texan Resort     Materials / Views / Stored Procedure will be added to conference info     Email matthew.vore@Westminster-mo.edu for copies in the meantime  Questions? Suggestions? Comments?",
    "token_count_estimate": 4090
}